import{g as c,t as i,i as re,a as T,o as k,w as o,d as s,b as a,j as m,f as d,u as r,I as h,E as ie,e as y,n as me,p as ue,q as de,c as ce,P as U,l as q}from"./app-BGxfkQyo.js";import{_ as pe,a as _e,b as fe,E as w}from"./lodash-B8vTn4c7.js";import{u as ge,E as ve,a as be,S as he,b as ye}from"./SkeletonTable-D3dCL_hH.js";import{_ as we}from"./SelectProductCategory-CbB850s6.js";import{_ as Ee}from"./ImageUpload-BKts1VHv.js";import{u as $e}from"./baseComposable-D_W31vg_.js";import{E as Ve,a as ke}from"./index-D86IKBYl.js";import{E as Ce}from"./index-BJIagJY3.js";import{E as Se}from"./index-D_ov1zZm.js";import{E as Be,a as De}from"./index-CyV8PQJT.js";import{E as Ie}from"./index-CyDS6CXJ.js";import{E as Te}from"./index-DY15ID-N.js";import{E as Ue,a as qe}from"./index-CvhItr7_.js";import{E as xe}from"./index-DDRuwiU-.js";import"./scroll-B9W2qgUL.js";import"./index-CYh1QxFF.js";import"./validator-DuQ1bq1g.js";import"./index-BPi1rbym.js";import"./position-BiuuCdhY.js";import"./directive-Chdceyer.js";const ze={class:"content"},Fe={class:"content-header"},Me={class:"mt-auto mb-0"},je={class:"text-lg font-semibold"},Ne={class:"mt-auto mb-0"},Pe={class:"flex justify-between items-center p-4"},Re={class:"flex items-center gap-2"},Le={class:"flex justify-between items-center p-4"},Ae={class:"flex items-center gap-2"},He={class:"flex items-center gap-2"},Ke={key:0,class:"bg-teal-100 mb-4 border-t-4 border-teal-500 rounded-b text-teal-900 px-4 py-3 shadow-md",role:"alert"},Oe={class:"flex"},Qe={class:"font-bold"},Ge={class:"text-sm"},Je={class:"text-end"},ha={__name:"Category",setup(We){const{objectToFormData:j}=$e(),p=c({page:1,limit:25,search:""}),N=c([]),P=async({queryKey:e})=>{const[t,u]=e;return(await q.get("/product/category/data",{params:u})).data},{data:_,isLoading:C,isError:Xe,error:Ye,refetch:g}=ge({queryKey:["fetchData",p.value],queryFn:P,keepPreviousData:!0}),R=pe.debounce(()=>{p.value.page=1,g()},1e3),L=e=>{N.value=e},A=()=>{g()},H=e=>{p.value.page=e,g()},K=(e,t)=>{var u="";if(e)for(let f=0;f<=e;f++)u+="â€”";return u+" "+t},S=c(null),v=c(!1),B=c(""),l=c({id:null,origin:null,name:null,parent_id:null,description:null,locale:"id",image:null}),O=c({name:[{required:!0,message:i("validation.required",{attribute:i("common.name")}),trigger:"blur"}]}),D=c(!1),Q=()=>{B.value=`${i("common.create")} ${i("base.category")}`,v.value=!0,l.value.id=null,l.value.name=null,l.value.parent_id=null,l.value.description=null,l.value.locale="id",l.value.image=null},x=(e,t="id")=>{B.value=`${i("common.edit")} ${i("base.category")}`,v.value=!0,l.value.id=e.id,l.value.parent_id=e.parent_id,l.value.image=e.image!="/images/placeholder/product.png"?e.image:null,l.value.locale=t,t=="en"?(l.value.origin=e.name,l.value.name=e.translations.length>1?e.translations[1].name:null,l.value.description=e.translations.length>1?e.translations[1].description:null):(l.value.name=e.name,l.value.description=e.description)},z=()=>{v.value=!1,l.value.id=null,l.value.name=null,l.value.parent_id=null,l.value.description=null,l.value.locale="id",l.value.image=null},G=async()=>{S.value&&S.value.validate(async e=>{if(e){const t=xe.service({customClass:"rounded-md",target:document.querySelector("#modalForm")});try{D.value=!0;const u=l.value.id?`/product/category/${l.value.id}/update`:"/product/category/store",f="post",E=j(l.value);await q({method:f,url:u,data:E,headers:{"Content-Type":"multipart/form-data"}}),D.value=!1,v.value=!1,g(),z(),w({message:i("message.success_save"),type:"success"})}catch(u){console.log(u),D.value=!1,w({message:i("message.error_server"),type:"error"})}t.close()}else w({message:i("message.error_input"),type:"error"})})},J=e=>{ye.confirm(i("message.delete_confirm"),i("message.delete_confirm_title"),{confirmButtonText:i("common.ok"),cancelButtonText:i("common.cancel"),type:"warning"}).then(()=>{q.delete(`/product/category/${e}/delete`).then(()=>{g(),w({type:"success",message:i("message.delete_success")})}).catch(t=>{w({type:"error",message:i("message.delete_cancel")})})}).catch(()=>{w({type:"info",message:i("message.delete_cancel")})})};return(e,t)=>{const u=ke,f=Ve,E=fe,W=_e,I=Se,$=ie,b=De,X=Ie,F=de,Y=ue,Z=me,ee=Be,ae=be,le=ve,oe=Ce,V=qe,te=Ue,ne=Te,se=re("base-layout");return k(),T(se,null,{default:o(()=>[s("div",ze,[s("div",Fe,[s("div",Me,[s("div",je,m(e.$t("base.category")),1)]),s("div",Ne,[a(f,{separator:"/"},{default:o(()=>[a(u,{to:{path:"/dashboard"}},{default:o(()=>[d(m(e.$t("base.dashboard")),1)]),_:1}),a(u,null,{default:o(()=>[d(m(e.$t("base.product")),1)]),_:1})]),_:1})])]),a(oe,{"body-class":"!p-0",class:"!rounded-lg !shadow-md !mb-10"},{default:o(()=>[s("div",Pe,[a(W,{modelValue:p.value.limit,"onUpdate:modelValue":t[0]||(t[0]=n=>p.value.limit=n),placeholder:e.$t("common.select"),class:"w-24",onChange:r(g),disable:r(C)},{default:o(()=>[a(E,{label:"25",value:"25"}),a(E,{label:"50",value:"50"}),a(E,{label:"100",value:"100"})]),_:1},8,["modelValue","placeholder","onChange","disable"]),s("div",Re,[a(I,{modelValue:p.value.search,"onUpdate:modelValue":t[1]||(t[1]=n=>p.value.search=n),clearable:"",onInput:r(R),disable:r(C)},{prefix:o(()=>[a(r(h),{icon:"mingcute:search-line"})]),_:1},8,["modelValue","onInput","disable"]),a($,{type:"primary",onClick:y(Q,["prevent"])},{default:o(()=>[a(r(h),{icon:"mingcute:add-line",class:"me-2"}),d(" "+m(e.$t("common.create")),1)]),_:1})])]),a(le,{loading:r(C),animated:""},{template:o(()=>[a(he)]),default:o(()=>[a(ee,{class:"min-w-full",data:r(_).data,onSortChange:A,onSelectionChange:L},{default:o(()=>[a(b,{type:"selection",width:"55"}),a(b,{label:e.$t("common.image"),width:"90"},{default:o(n=>[a(X,{class:"!w-14 !h-14 rounded-md me-2",src:n.row.image,"preview-src-list":[n.row.image],"initial-index":0,"preview-teleported":""},null,8,["src","preview-src-list"])]),_:1},8,["label"]),a(b,{label:e.$t("common.name"),sortable:""},{default:o(n=>[d(m(K(n.row.depth,n.row.name)),1)]),_:1},8,["label"]),a(b,{prop:"product_count",label:e.$t("common.total_data",{data:e.$t("base.product")}),sortable:""},null,8,["label"]),a(b,{width:"60","header-align":"center"},{header:o(()=>[a(r(h),{icon:"flag:us-1x1"})]),default:o(n=>[a($,{size:"small",onClick:y(M=>x(n.row,"en"),["prevent"])},{default:o(()=>[a(r(h),{icon:n.row.translations.length>1?"mingcute:edit-3-fill":"mingcute:plus-fill"},null,8,["icon"])]),_:2},1032,["onClick"])]),_:1}),a(b,{label:e.$t("common.action"),align:"center",width:"150"},{default:o(n=>[a(Z,{"popper-class":"dropdown-action",trigger:"click"},{dropdown:o(()=>[a(Y,null,{default:o(()=>[a(F,{class:"flex justify-between",onClick:y(M=>x(n.row),["prevent"])},{default:o(()=>[a(r(h),{icon:"mingcute:edit-line",class:"me-2"}),d(" "+m(e.$t("common.edit")),1)]),_:2},1032,["onClick"]),a(F,{class:"flex justify-between",onClick:y(M=>J(n.row.id),["prevent"])},{default:o(()=>[a(r(h),{icon:"mingcute:delete-2-line",class:"me-2"}),d(" "+m(e.$t("common.delete")),1)]),_:2},1032,["onClick"])]),_:2},1024)]),default:o(()=>[a($,{type:"primary"},{default:o(()=>[d(m(e.$t("common.action")),1)]),_:1})]),_:2},1024)]),_:1},8,["label"])]),_:1},8,["data"]),s("div",Le,[s("div",Ae,[s("span",null,m(e.$t("common.table_paginate",{from:r(_).from,to:r(_).to,total:r(_).total})),1)]),s("div",He,[a(ae,{class:"float-end",background:"",layout:"prev, pager, next","page-size":r(_).per_page,total:r(_).total,"current-page":r(_).current_page,onCurrentChange:H},null,8,["page-size","total","current-page"])])])]),_:1},8,["loading"])]),_:1}),a(ne,{id:"modalForm",modelValue:v.value,"onUpdate:modelValue":t[6]||(t[6]=n=>v.value=n),title:B.value,class:"!sm:w-full !w-1/3 rounded-lg","close-on-click-modal":!1,"close-on-press-escape":!1},{default:o(()=>[a(te,{"label-position":"top",ref_key:"formRef",ref:S,model:l.value,rules:O.value,onSubmit:y(G,["prevent"])},{default:o(()=>[l.value.locale=="en"?(k(),ce("div",Ke,[s("div",Oe,[t[7]||(t[7]=s("div",{class:"py-1"},[s("svg",{class:"fill-current h-6 w-6 text-teal-500 mr-4",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20"},[s("path",{d:"M2.93 17.07A10 10 0 1 1 17.07 2.93 10 10 0 0 1 2.93 17.07zm12.73-1.41A8 8 0 1 0 4.34 4.34a8 8 0 0 0 11.32 11.32zM9 11V9h2v6H9v-4zm0-6h2v2H9V5z"})])],-1)),s("div",null,[s("div",Qe,m(e.$t("common.translation_english")),1),s("div",Ge,m(l.value.origin),1)])])])):U("",!0),a(V,{label:e.$t("common.name"),prop:"name"},{default:o(()=>[a(I,{modelValue:l.value.name,"onUpdate:modelValue":t[2]||(t[2]=n=>l.value.name=n)},null,8,["modelValue"])]),_:1},8,["label"]),l.value.locale=="id"?(k(),T(V,{key:1,label:e.$t("common.parent_data",{data:e.$t("base.category")}),prop:"parent_id"},{default:o(()=>[a(we,{modelValue:l.value.parent_id,"onUpdate:modelValue":t[3]||(t[3]=n=>l.value.parent_id=n)},null,8,["modelValue"])]),_:1},8,["label"])):U("",!0),a(V,{label:e.$t("common.description"),prop:"description"},{default:o(()=>[a(I,{type:"textarea",modelValue:l.value.description,"onUpdate:modelValue":t[4]||(t[4]=n=>l.value.description=n),row:4},null,8,["modelValue"])]),_:1},8,["label"]),l.value.locale=="id"?(k(),T(V,{key:2,label:e.$t("common.image"),prop:"image"},{default:o(()=>[a(Ee,{modelValue:l.value.image,"onUpdate:modelValue":t[5]||(t[5]=n=>l.value.image=n),class:"w-28 h-28"},null,8,["modelValue"])]),_:1},8,["label"])):U("",!0),s("div",Je,[a($,{onClick:y(z,["prevent"])},{default:o(()=>[d(m(e.$t("common.cancel")),1)]),_:1}),a($,{type:"primary","native-type":"submit"},{default:o(()=>[d(m(e.$t("common.save")),1)]),_:1})])]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])])]),_:1})}}};export{ha as default};
