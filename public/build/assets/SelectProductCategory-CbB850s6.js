import{_ as de,C as I,G as j,a as M,o as T,w as oe,r as be,ah as qe,aS as _e,u as Re,aT as Ue,a0 as Ke,ac as he,s as We,aJ as U,aF as fe,af as se,aM as te,v as Ae,aG as Ye,am as Ge,ad as F,aB as ee,ag as ne,g as x,aU as ce,aV as Xe,i as $,k as ye,aj as ge,c as W,d as pe,b as ue,P as J,S as Je,e as P,R as A,W as Ze,a1 as Be,a2 as Le,V as Qe,U as et,M as w,X as V,aW as tt,a8 as Ee,a6 as Se,h as De,aD as nt,aC as dt,a7 as L,j as at,B as ot,a5 as st,K as H,aX as rt,aY as le,ar as Me,aZ as it,a9 as lt,a4 as ct,l as ut}from"./app-BGxfkQyo.js";import{s as Ie,a as Ne,b as Te,i as ht,e as ft}from"./lodash-B8vTn4c7.js";import{b as yt}from"./index-CyV8PQJT.js";import{U as Z}from"./index-D_ov1zZm.js";const gt=I({name:"ElCollapseTransition"}),pt=I({...gt,setup(e){const t=j("collapse-transition"),d=n=>{n.style.maxHeight="",n.style.overflow=n.dataset.oldOverflow,n.style.paddingTop=n.dataset.oldPaddingTop,n.style.paddingBottom=n.dataset.oldPaddingBottom},a={beforeEnter(n){n.dataset||(n.dataset={}),n.dataset.oldPaddingTop=n.style.paddingTop,n.dataset.oldPaddingBottom=n.style.paddingBottom,n.style.height&&(n.dataset.elExistsHeight=n.style.height),n.style.maxHeight=0,n.style.paddingTop=0,n.style.paddingBottom=0},enter(n){requestAnimationFrame(()=>{n.dataset.oldOverflow=n.style.overflow,n.dataset.elExistsHeight?n.style.maxHeight=n.dataset.elExistsHeight:n.scrollHeight!==0?n.style.maxHeight=`${n.scrollHeight}px`:n.style.maxHeight=0,n.style.paddingTop=n.dataset.oldPaddingTop,n.style.paddingBottom=n.dataset.oldPaddingBottom,n.style.overflow="hidden"})},afterEnter(n){n.style.maxHeight="",n.style.overflow=n.dataset.oldOverflow},enterCancelled(n){d(n)},beforeLeave(n){n.dataset||(n.dataset={}),n.dataset.oldPaddingTop=n.style.paddingTop,n.dataset.oldPaddingBottom=n.style.paddingBottom,n.dataset.oldOverflow=n.style.overflow,n.style.maxHeight=`${n.scrollHeight}px`,n.style.overflow="hidden"},leave(n){n.scrollHeight!==0&&(n.style.maxHeight=0,n.style.paddingTop=0,n.style.paddingBottom=0)},afterLeave(n){d(n)},leaveCancelled(n){d(n)}};return(n,o)=>(T(),M(Ue,qe({name:Re(t).b()},_e(a)),{default:oe(()=>[be(n.$slots,"default")]),_:3},16,["name"]))}});var Nt=de(pt,[["__file","collapse-transition.vue"]]);const Ct=Ke(Nt),Y="$treeNodeId",Oe=function(e,t){!t||t[Y]||Object.defineProperty(t,Y,{value:e.id,enumerable:!1,configurable:!1,writable:!1})},xe=function(e,t){return e?t[e]:t[Y]},Ce=(e,t,d)=>{const a=e.value.currentNode;d();const n=e.value.currentNode;a!==n&&t("current-change",n?n.data:null,n)},ke=e=>{let t=!0,d=!0,a=!0;for(let n=0,o=e.length;n<o;n++){const r=e[n];(r.checked!==!0||r.indeterminate)&&(t=!1,r.disabled||(a=!1)),(r.checked!==!1||r.indeterminate)&&(d=!1)}return{all:t,none:d,allWithoutDisable:a,half:!t&&!d}},Q=function(e){if(e.childNodes.length===0||e.loading)return;const{all:t,none:d,half:a}=ke(e.childNodes);t?(e.checked=!0,e.indeterminate=!1):a?(e.checked=!1,e.indeterminate=!0):d&&(e.checked=!1,e.indeterminate=!1);const n=e.parent;!n||n.level===0||e.store.checkStrictly||Q(n)},ae=function(e,t){const d=e.store.props,a=e.data||{},n=d[t];if(te(n))return n(a,e);if(Ae(n))return a[n];if(fe(n)){const o=a[t];return o===void 0?"":o}};let kt=0;class z{constructor(t){this.id=kt++,this.text=null,this.checked=!1,this.indeterminate=!1,this.data=null,this.expanded=!1,this.parent=null,this.visible=!0,this.isCurrent=!1,this.canFocus=!1;for(const d in t)he(t,d)&&(this[d]=t[d]);this.level=0,this.loaded=!1,this.childNodes=[],this.loading=!1,this.parent&&(this.level=this.parent.level+1)}initialize(){const t=this.store;if(!t)throw new Error("[Node]store is required!");t.registerNode(this);const d=t.props;if(d&&typeof d.isLeaf<"u"){const o=ae(this,"isLeaf");We(o)&&(this.isLeafByUser=o)}if(t.lazy!==!0&&this.data?(this.setData(this.data),t.defaultExpandAll&&(this.expanded=!0,this.canFocus=!0)):this.level>0&&t.lazy&&t.defaultExpandAll&&!this.isLeafByUser&&this.expand(),U(this.data)||Oe(this,this.data),!this.data)return;const a=t.defaultExpandedKeys,n=t.key;n&&a&&a.includes(this.key)&&this.expand(null,t.autoExpandParent),n&&t.currentNodeKey!==void 0&&this.key===t.currentNodeKey&&(t.currentNode=this,t.currentNode.isCurrent=!0),t.lazy&&t._initDefaultCheckedNode(this),this.updateLeafState(),this.parent&&(this.level===1||this.parent.expanded===!0)&&(this.canFocus=!0)}setData(t){U(t)||Oe(this,t),this.data=t,this.childNodes=[];let d;this.level===0&&U(this.data)?d=this.data:d=ae(this,"children")||[];for(let a=0,n=d.length;a<n;a++)this.insertChild({data:d[a]})}get label(){return ae(this,"label")}get key(){const t=this.store.key;return this.data?this.data[t]:null}get disabled(){return ae(this,"disabled")}get nextSibling(){const t=this.parent;if(t){const d=t.childNodes.indexOf(this);if(d>-1)return t.childNodes[d+1]}return null}get previousSibling(){const t=this.parent;if(t){const d=t.childNodes.indexOf(this);if(d>-1)return d>0?t.childNodes[d-1]:null}return null}contains(t,d=!0){return(this.childNodes||[]).some(a=>a===t||d&&a.contains(t))}remove(){const t=this.parent;t&&t.removeChild(this)}insertChild(t,d,a){if(!t)throw new Error("InsertChild error: child is required.");if(!(t instanceof z)){if(!a){const n=this.getChildren(!0);n.includes(t.data)||(fe(d)||d<0?n.push(t.data):n.splice(d,0,t.data))}Object.assign(t,{parent:this,store:this.store}),t=se(new z(t)),t instanceof z&&t.initialize()}t.level=this.level+1,fe(d)||d<0?this.childNodes.push(t):this.childNodes.splice(d,0,t),this.updateLeafState()}insertBefore(t,d){let a;d&&(a=this.childNodes.indexOf(d)),this.insertChild(t,a)}insertAfter(t,d){let a;d&&(a=this.childNodes.indexOf(d),a!==-1&&(a+=1)),this.insertChild(t,a)}removeChild(t){const d=this.getChildren()||[],a=d.indexOf(t.data);a>-1&&d.splice(a,1);const n=this.childNodes.indexOf(t);n>-1&&(this.store&&this.store.deregisterNode(t),t.parent=null,this.childNodes.splice(n,1)),this.updateLeafState()}removeChildByData(t){let d=null;for(let a=0;a<this.childNodes.length;a++)if(this.childNodes[a].data===t){d=this.childNodes[a];break}d&&this.removeChild(d)}expand(t,d){const a=()=>{if(d){let n=this.parent;for(;n.level>0;)n.expanded=!0,n=n.parent}this.expanded=!0,t&&t(),this.childNodes.forEach(n=>{n.canFocus=!0})};this.shouldLoadData()?this.loadData(n=>{U(n)&&(this.checked?this.setChecked(!0,!0):this.store.checkStrictly||Q(this),a())}):a()}doCreateChildren(t,d={}){t.forEach(a=>{this.insertChild(Object.assign({data:a},d),void 0,!0)})}collapse(){this.expanded=!1,this.childNodes.forEach(t=>{t.canFocus=!1})}shouldLoadData(){return this.store.lazy===!0&&this.store.load&&!this.loaded}updateLeafState(){if(this.store.lazy===!0&&this.loaded!==!0&&typeof this.isLeafByUser<"u"){this.isLeaf=this.isLeafByUser;return}const t=this.childNodes;if(!this.store.lazy||this.store.lazy===!0&&this.loaded===!0){this.isLeaf=!t||t.length===0;return}this.isLeaf=!1}setChecked(t,d,a,n){if(this.indeterminate=t==="half",this.checked=t===!0,this.store.checkStrictly)return;if(!(this.shouldLoadData()&&!this.store.checkDescendants)){const{all:r,allWithoutDisable:u}=ke(this.childNodes);!this.isLeaf&&!r&&u&&(this.checked=!1,t=!1);const i=()=>{if(d){const N=this.childNodes;for(let s=0,c=N.length;s<c;s++){const y=N[s];n=n||t!==!1;const g=y.disabled?y.checked:n;y.setChecked(g,d,!0,n)}const{half:l,all:h}=ke(N);h||(this.checked=h,this.indeterminate=l)}};if(this.shouldLoadData()){this.loadData(()=>{i(),Q(this)},{checked:t!==!1});return}else i()}const o=this.parent;!o||o.level===0||a||Q(o)}getChildren(t=!1){if(this.level===0)return this.data;const d=this.data;if(!d)return null;const a=this.store.props;let n="children";return a&&(n=a.children||"children"),d[n]===void 0&&(d[n]=null),t&&!d[n]&&(d[n]=[]),d[n]}updateChildren(){const t=this.getChildren()||[],d=this.childNodes.map(o=>o.data),a={},n=[];t.forEach((o,r)=>{const u=o[Y];!!u&&d.findIndex(N=>N[Y]===u)>=0?a[u]={index:r,data:o}:n.push({index:r,data:o})}),this.store.lazy||d.forEach(o=>{a[o[Y]]||this.removeChildByData(o)}),n.forEach(({index:o,data:r})=>{this.insertChild({data:r},o)}),this.updateLeafState()}loadData(t,d={}){if(this.store.lazy===!0&&this.store.load&&!this.loaded&&(!this.loading||Object.keys(d).length)){this.loading=!0;const a=o=>{this.childNodes=[],this.doCreateChildren(o,d),this.loaded=!0,this.loading=!1,this.updateLeafState(),t&&t.call(this,o)},n=()=>{this.loading=!1};this.store.load(this,a,n)}else t&&t.call(this)}eachNode(t){const d=[this];for(;d.length;){const a=d.shift();d.unshift(...a.childNodes),t(a)}}reInitChecked(){this.store.checkStrictly||Q(this)}}class vt{constructor(t){this.currentNode=null,this.currentNodeKey=null;for(const d in t)he(t,d)&&(this[d]=t[d]);this.nodesMap={}}initialize(){if(this.root=new z({data:this.data,store:this}),this.root.initialize(),this.lazy&&this.load){const t=this.load;t(this.root,d=>{this.root.doCreateChildren(d),this._initDefaultCheckedNodes()})}else this._initDefaultCheckedNodes()}filter(t){const d=this.filterNodeMethod,a=this.lazy,n=function(o){const r=o.root?o.root.childNodes:o.childNodes;if(r.forEach(u=>{u.visible=d.call(u,t,u.data,u),n(u)}),!o.visible&&r.length){let u=!0;u=!r.some(i=>i.visible),o.root?o.root.visible=u===!1:o.visible=u===!1}t&&o.visible&&!o.isLeaf&&(!a||o.loaded)&&o.expand()};n(this)}setData(t){t!==this.root.data?(this.nodesMap={},this.root.setData(t),this._initDefaultCheckedNodes(),this.setCurrentNodeKey(this.currentNodeKey)):this.root.updateChildren()}getNode(t){if(t instanceof z)return t;const d=Ye(t)?xe(this.key,t):t;return this.nodesMap[d]||null}insertBefore(t,d){const a=this.getNode(d);a.parent.insertBefore({data:t},a)}insertAfter(t,d){const a=this.getNode(d);a.parent.insertAfter({data:t},a)}remove(t){const d=this.getNode(t);d&&d.parent&&(d===this.currentNode&&(this.currentNode=null),d.parent.removeChild(d))}append(t,d){const a=Ge(d)?this.root:this.getNode(d);a&&a.insertChild({data:t})}_initDefaultCheckedNodes(){const t=this.defaultCheckedKeys||[],d=this.nodesMap;t.forEach(a=>{const n=d[a];n&&n.setChecked(!0,!this.checkStrictly)})}_initDefaultCheckedNode(t){(this.defaultCheckedKeys||[]).includes(t.key)&&t.setChecked(!0,!this.checkStrictly)}setDefaultCheckedKey(t){t!==this.defaultCheckedKeys&&(this.defaultCheckedKeys=t,this._initDefaultCheckedNodes())}registerNode(t){const d=this.key;!t||!t.data||(d?t.key!==void 0&&(this.nodesMap[t.key]=t):this.nodesMap[t.id]=t)}deregisterNode(t){!this.key||!t||!t.data||(t.childNodes.forEach(a=>{this.deregisterNode(a)}),delete this.nodesMap[t.key])}getCheckedNodes(t=!1,d=!1){const a=[],n=function(o){(o.root?o.root.childNodes:o.childNodes).forEach(u=>{(u.checked||d&&u.indeterminate)&&(!t||t&&u.isLeaf)&&a.push(u.data),n(u)})};return n(this),a}getCheckedKeys(t=!1){return this.getCheckedNodes(t).map(d=>(d||{})[this.key])}getHalfCheckedNodes(){const t=[],d=function(a){(a.root?a.root.childNodes:a.childNodes).forEach(o=>{o.indeterminate&&t.push(o.data),d(o)})};return d(this),t}getHalfCheckedKeys(){return this.getHalfCheckedNodes().map(t=>(t||{})[this.key])}_getAllNodes(){const t=[],d=this.nodesMap;for(const a in d)he(d,a)&&t.push(d[a]);return t}updateChildren(t,d){const a=this.nodesMap[t];if(!a)return;const n=a.childNodes;for(let o=n.length-1;o>=0;o--){const r=n[o];this.remove(r.data)}for(let o=0,r=d.length;o<r;o++){const u=d[o];this.append(u,a.data)}}_setCheckedKeys(t,d=!1,a){const n=this._getAllNodes().sort((i,N)=>i.level-N.level),o=Object.create(null),r=Object.keys(a);n.forEach(i=>i.setChecked(!1,!1));const u=i=>{i.childNodes.forEach(N=>{var l;o[N.data[t]]=!0,(l=N.childNodes)!=null&&l.length&&u(N)})};for(let i=0,N=n.length;i<N;i++){const l=n[i],h=l.data[t].toString();if(!r.includes(h)){l.checked&&!o[h]&&l.setChecked(!1,!1);continue}if(l.childNodes.length&&u(l),l.isLeaf||this.checkStrictly){l.setChecked(!0,!1);continue}if(l.setChecked(!0,!0),d){l.setChecked(!1,!1);const c=function(y){y.childNodes.forEach(C=>{C.isLeaf||C.setChecked(!1,!1),c(C)})};c(l)}}}setCheckedNodes(t,d=!1){const a=this.key,n={};t.forEach(o=>{n[(o||{})[a]]=!0}),this._setCheckedKeys(a,d,n)}setCheckedKeys(t,d=!1){this.defaultCheckedKeys=t;const a=this.key,n={};t.forEach(o=>{n[o]=!0}),this._setCheckedKeys(a,d,n)}setDefaultExpandedKeys(t){t=t||[],this.defaultExpandedKeys=t,t.forEach(d=>{const a=this.getNode(d);a&&a.expand(null,this.autoExpandParent)})}setChecked(t,d,a){const n=this.getNode(t);n&&n.setChecked(!!d,a)}getCurrentNode(){return this.currentNode}setCurrentNode(t){const d=this.currentNode;d&&(d.isCurrent=!1),this.currentNode=t,this.currentNode.isCurrent=!0}setUserCurrentNode(t,d=!0){const a=t[this.key],n=this.nodesMap[a];this.setCurrentNode(n),d&&this.currentNode.level>1&&this.currentNode.parent.expand(null,!0)}setCurrentNodeKey(t,d=!0){if(this.currentNodeKey=t,t==null){this.currentNode&&(this.currentNode.isCurrent=!1),this.currentNode=null;return}const a=this.getNode(t);a&&(this.setCurrentNode(a),d&&this.currentNode.level>1&&this.currentNode.parent.expand(null,!0))}}const mt=I({name:"ElTreeNodeContent",props:{node:{type:Object,required:!0},renderContent:Function},setup(e){const t=j("tree"),d=F("NodeInstance"),a=F("RootTree");return()=>{const n=e.node,{data:o,store:r}=n;return e.renderContent?e.renderContent(ee,{_self:d,node:n,data:o,store:r}):be(a.ctx.slots,"default",{node:n,data:o},()=>[ee("span",{class:t.be("node","label")},[n.label])])}}});var bt=de(mt,[["__file","tree-node-content.vue"]]);function Pe(e){const t=F("TreeNodeMap",null),d={treeNodeExpand:a=>{e.node!==a&&e.node.collapse()},children:[]};return t&&t.children.push(d),ne("TreeNodeMap",d),{broadcastExpanded:a=>{if(e.accordion)for(const n of d.children)n.treeNodeExpand(a)}}}const $e=Symbol("dragEvents");function Kt({props:e,ctx:t,el$:d,dropIndicator$:a,store:n}){const o=j("tree"),r=x({showDropIndicator:!1,draggingNode:null,dropNode:null,allowDrop:!0,dropType:null});return ne($e,{treeNodeDragStart:({event:l,treeNode:h})=>{if(te(e.allowDrag)&&!e.allowDrag(h.node))return l.preventDefault(),!1;l.dataTransfer.effectAllowed="move";try{l.dataTransfer.setData("text/plain","")}catch{}r.value.draggingNode=h,t.emit("node-drag-start",h.node,l)},treeNodeDragOver:({event:l,treeNode:h})=>{const s=h,c=r.value.dropNode;c&&c.node.id!==s.node.id&&ce(c.$el,o.is("drop-inner"));const y=r.value.draggingNode;if(!y||!s)return;let g=!0,C=!0,b=!0,D=!0;te(e.allowDrop)&&(g=e.allowDrop(y.node,s.node,"prev"),D=C=e.allowDrop(y.node,s.node,"inner"),b=e.allowDrop(y.node,s.node,"next")),l.dataTransfer.dropEffect=C||g||b?"move":"none",(g||C||b)&&(c==null?void 0:c.node.id)!==s.node.id&&(c&&t.emit("node-drag-leave",y.node,c.node,l),t.emit("node-drag-enter",y.node,s.node,l)),g||C||b?r.value.dropNode=s:r.value.dropNode=null,s.node.nextSibling===y.node&&(b=!1),s.node.previousSibling===y.node&&(g=!1),s.node.contains(y.node,!1)&&(C=!1),(y.node===s.node||y.node.contains(s.node))&&(g=!1,C=!1,b=!1);const S=s.$el.querySelector(`.${o.be("node","content")}`).getBoundingClientRect(),k=d.value.getBoundingClientRect();let K;const q=g?C?.25:b?.45:1:-1,O=b?C?.75:g?.55:0:1;let _=-9999;const p=l.clientY-S.top;p<S.height*q?K="before":p>S.height*O?K="after":C?K="inner":K="none";const m=s.$el.querySelector(`.${o.be("node","expand-icon")}`).getBoundingClientRect(),E=a.value;K==="before"?_=m.top-k.top:K==="after"&&(_=m.bottom-k.top),E.style.top=`${_}px`,E.style.left=`${m.right-k.left}px`,K==="inner"?Xe(s.$el,o.is("drop-inner")):ce(s.$el,o.is("drop-inner")),r.value.showDropIndicator=K==="before"||K==="after",r.value.allowDrop=r.value.showDropIndicator||D,r.value.dropType=K,t.emit("node-drag-over",y.node,s.node,l)},treeNodeDragEnd:l=>{const{draggingNode:h,dropType:s,dropNode:c}=r.value;if(l.preventDefault(),l.dataTransfer&&(l.dataTransfer.dropEffect="move"),h&&c){const y={data:h.node.data};s!=="none"&&h.node.remove(),s==="before"?c.node.parent.insertBefore(y,c.node):s==="after"?c.node.parent.insertAfter(y,c.node):s==="inner"&&c.node.insertChild(y),s!=="none"&&(n.value.registerNode(y),n.value.key&&h.node.eachNode(g=>{var C;(C=n.value.nodesMap[g.data[n.value.key]])==null||C.setChecked(g.checked,!n.value.checkStrictly)})),ce(c.$el,o.is("drop-inner")),t.emit("node-drag-end",h.node,c.node,s,l),s!=="none"&&t.emit("node-drop",h.node,c.node,s,l)}h&&!c&&t.emit("node-drag-end",h.node,null,s,l),r.value.showDropIndicator=!1,r.value.draggingNode=null,r.value.dropNode=null,r.value.allowDrop=!0}}),{dragState:r}}const Et=I({name:"ElTreeNode",components:{ElCollapseTransition:Ct,ElCheckbox:yt,NodeContent:bt,ElIcon:et,Loading:Qe},props:{node:{type:z,default:()=>({})},props:{type:Object,default:()=>({})},accordion:Boolean,renderContent:Function,renderAfterExpand:Boolean,showCheckbox:{type:Boolean,default:!1}},emits:["node-expand"],setup(e,t){const d=j("tree"),{broadcastExpanded:a}=Pe(e),n=F("RootTree"),o=x(!1),r=x(!1),u=x(null),i=x(null),N=x(null),l=F($e),h=Ee();ne("NodeInstance",h),e.node.expanded&&(o.value=!0,r.value=!0);const s=n.props.props.children||"children";w(()=>{const p=e.node.data[s];return p&&[...p]},()=>{e.node.updateChildren()}),w(()=>e.node.indeterminate,p=>{g(e.node.checked,p)}),w(()=>e.node.checked,p=>{g(p,e.node.indeterminate)}),w(()=>e.node.childNodes.length,()=>e.node.reInitChecked()),w(()=>e.node.expanded,p=>{V(()=>o.value=p),p&&(r.value=!0)});const c=p=>xe(n.props.nodeKey,p.data),y=p=>{const m=e.props.class;if(!m)return{};let E;if(te(m)){const{data:G}=p;E=m(G,p)}else E=m;return Ae(E)?{[E]:!0}:E},g=(p,m)=>{(u.value!==p||i.value!==m)&&n.ctx.emit("check-change",e.node.data,p,m),u.value=p,i.value=m},C=p=>{Ce(n.store,n.ctx.emit,()=>{var m;if((m=n==null?void 0:n.props)==null?void 0:m.nodeKey){const G=c(e.node);n.store.value.setCurrentNodeKey(G)}else n.store.value.setCurrentNode(e.node)}),n.currentNode.value=e.node,n.props.expandOnClickNode&&D(),n.props.checkOnClickNode&&!e.node.disabled&&S(null,{target:{checked:!e.node.checked}}),n.ctx.emit("node-click",e.node.data,e.node,h,p)},b=p=>{n.instance.vnode.props.onNodeContextmenu&&(p.stopPropagation(),p.preventDefault()),n.ctx.emit("node-contextmenu",p,e.node.data,e.node,h)},D=()=>{e.node.isLeaf||(o.value?(n.ctx.emit("node-collapse",e.node.data,e.node,h),e.node.collapse()):e.node.expand(()=>{t.emit("node-expand",e.node.data,e.node,h)}))},S=(p,m)=>{e.node.setChecked(m.target.checked,!n.props.checkStrictly),V(()=>{const E=n.store.value;n.ctx.emit("check",e.node.data,{checkedNodes:E.getCheckedNodes(),checkedKeys:E.getCheckedKeys(),halfCheckedNodes:E.getHalfCheckedNodes(),halfCheckedKeys:E.getHalfCheckedKeys()})})};return{ns:d,node$:N,tree:n,expanded:o,childNodeRendered:r,oldChecked:u,oldIndeterminate:i,getNodeKey:c,getNodeClass:y,handleSelectChange:g,handleClick:C,handleContextMenu:b,handleExpandIconClick:D,handleCheckChange:S,handleChildNodeExpand:(p,m,E)=>{a(m),n.ctx.emit("node-expand",p,m,E)},handleDragStart:p=>{n.props.draggable&&l.treeNodeDragStart({event:p,treeNode:e})},handleDragOver:p=>{p.preventDefault(),n.props.draggable&&l.treeNodeDragOver({event:p,treeNode:{$el:N.value,node:e.node}})},handleDrop:p=>{p.preventDefault()},handleDragEnd:p=>{n.props.draggable&&l.treeNodeDragEnd(p)},CaretRight:tt}}});function Dt(e,t,d,a,n,o){const r=$("el-icon"),u=$("el-checkbox"),i=$("loading"),N=$("node-content"),l=$("el-tree-node"),h=$("el-collapse-transition");return ye((T(),W("div",{ref:"node$",class:A([e.ns.b("node"),e.ns.is("expanded",e.expanded),e.ns.is("current",e.node.isCurrent),e.ns.is("hidden",!e.node.visible),e.ns.is("focusable",!e.node.disabled),e.ns.is("checked",!e.node.disabled&&e.node.checked),e.getNodeClass(e.node)]),role:"treeitem",tabindex:"-1","aria-expanded":e.expanded,"aria-disabled":e.node.disabled,"aria-checked":e.node.checked,draggable:e.tree.props.draggable,"data-key":e.getNodeKey(e.node),onClick:P(e.handleClick,["stop"]),onContextmenu:e.handleContextMenu,onDragstart:P(e.handleDragStart,["stop"]),onDragover:P(e.handleDragOver,["stop"]),onDragend:P(e.handleDragEnd,["stop"]),onDrop:P(e.handleDrop,["stop"])},[pe("div",{class:A(e.ns.be("node","content")),style:Ze({paddingLeft:(e.node.level-1)*e.tree.props.indent+"px"})},[e.tree.props.icon||e.CaretRight?(T(),M(r,{key:0,class:A([e.ns.be("node","expand-icon"),e.ns.is("leaf",e.node.isLeaf),{expanded:!e.node.isLeaf&&e.expanded}]),onClick:P(e.handleExpandIconClick,["stop"])},{default:oe(()=>[(T(),M(Je(e.tree.props.icon||e.CaretRight)))]),_:1},8,["class","onClick"])):J("v-if",!0),e.showCheckbox?(T(),M(u,{key:1,"model-value":e.node.checked,indeterminate:e.node.indeterminate,disabled:!!e.node.disabled,onClick:P(()=>{},["stop"]),onChange:e.handleCheckChange},null,8,["model-value","indeterminate","disabled","onClick","onChange"])):J("v-if",!0),e.node.loading?(T(),M(r,{key:2,class:A([e.ns.be("node","loading-icon"),e.ns.is("loading")])},{default:oe(()=>[ue(i)]),_:1},8,["class"])):J("v-if",!0),ue(N,{node:e.node,"render-content":e.renderContent},null,8,["node","render-content"])],6),ue(h,null,{default:oe(()=>[!e.renderAfterExpand||e.childNodeRendered?ye((T(),W("div",{key:0,class:A(e.ns.be("node","children")),role:"group","aria-expanded":e.expanded},[(T(!0),W(Be,null,Le(e.node.childNodes,s=>(T(),M(l,{key:e.getNodeKey(s),"render-content":e.renderContent,"render-after-expand":e.renderAfterExpand,"show-checkbox":e.showCheckbox,node:s,accordion:e.accordion,props:e.props,onNodeExpand:e.handleChildNodeExpand},null,8,["render-content","render-after-expand","show-checkbox","node","accordion","props","onNodeExpand"]))),128))],10,["aria-expanded"])),[[ge,e.expanded]]):J("v-if",!0)]),_:1})],42,["aria-expanded","aria-disabled","aria-checked","draggable","data-key","onClick","onContextmenu","onDragstart","onDragover","onDragend","onDrop"])),[[ge,e.node.visible]])}var xt=de(Et,[["render",Dt],["__file","tree-node.vue"]]);function wt({el$:e},t){const d=j("tree"),a=Se([]),n=Se([]);De(()=>{r()}),nt(()=>{a.value=Array.from(e.value.querySelectorAll("[role=treeitem]")),n.value=Array.from(e.value.querySelectorAll("input[type=checkbox]"))}),w(n,u=>{u.forEach(i=>{i.setAttribute("tabindex","-1")})}),dt(e,"keydown",u=>{const i=u.target;if(!i.className.includes(d.b("node")))return;const N=u.code;a.value=Array.from(e.value.querySelectorAll(`.${d.is("focusable")}[role=treeitem]`));const l=a.value.indexOf(i);let h;if([L.up,L.down].includes(N)){if(u.preventDefault(),N===L.up){h=l===-1?0:l!==0?l-1:a.value.length-1;const c=h;for(;!t.value.getNode(a.value[h].dataset.key).canFocus;){if(h--,h===c){h=-1;break}h<0&&(h=a.value.length-1)}}else{h=l===-1?0:l<a.value.length-1?l+1:0;const c=h;for(;!t.value.getNode(a.value[h].dataset.key).canFocus;){if(h++,h===c){h=-1;break}h>=a.value.length&&(h=0)}}h!==-1&&a.value[h].focus()}[L.left,L.right].includes(N)&&(u.preventDefault(),i.click());const s=i.querySelector('[type="checkbox"]');[L.enter,L.numpadEnter,L.space].includes(N)&&s&&(u.preventDefault(),s.click())});const r=()=>{var u;a.value=Array.from(e.value.querySelectorAll(`.${d.is("focusable")}[role=treeitem]`)),n.value=Array.from(e.value.querySelectorAll("input[type=checkbox]"));const i=e.value.querySelectorAll(`.${d.is("checked")}[role=treeitem]`);if(i.length){i[0].setAttribute("tabindex","0");return}(u=a.value[0])==null||u.setAttribute("tabindex","0")}}const St=I({name:"ElTree",components:{ElTreeNode:xt},props:{data:{type:Array,default:()=>[]},emptyText:{type:String},renderAfterExpand:{type:Boolean,default:!0},nodeKey:String,checkStrictly:Boolean,defaultExpandAll:Boolean,expandOnClickNode:{type:Boolean,default:!0},checkOnClickNode:Boolean,checkDescendants:{type:Boolean,default:!1},autoExpandParent:{type:Boolean,default:!0},defaultCheckedKeys:Array,defaultExpandedKeys:Array,currentNodeKey:[String,Number],renderContent:Function,showCheckbox:{type:Boolean,default:!1},draggable:{type:Boolean,default:!1},allowDrag:Function,allowDrop:Function,props:{type:Object,default:()=>({children:"children",label:"label",disabled:"disabled"})},lazy:{type:Boolean,default:!1},highlightCurrent:Boolean,load:Function,filterNodeMethod:Function,accordion:Boolean,indent:{type:Number,default:18},icon:{type:ot}},emits:["check-change","current-change","node-click","node-contextmenu","node-collapse","node-expand","check","node-drag-start","node-drag-end","node-drop","node-drag-leave","node-drag-enter","node-drag-over"],setup(e,t){const{t:d}=st(),a=j("tree"),n=F(Ie,null),o=x(new vt({key:e.nodeKey,data:e.data,lazy:e.lazy,props:e.props,load:e.load,currentNodeKey:e.currentNodeKey,checkStrictly:e.checkStrictly,checkDescendants:e.checkDescendants,defaultCheckedKeys:e.defaultCheckedKeys,defaultExpandedKeys:e.defaultExpandedKeys,autoExpandParent:e.autoExpandParent,defaultExpandAll:e.defaultExpandAll,filterNodeMethod:e.filterNodeMethod}));o.value.initialize();const r=x(o.value.root),u=x(null),i=x(null),N=x(null),{broadcastExpanded:l}=Pe(e),{dragState:h}=Kt({props:e,ctx:t,el$:i,dropIndicator$:N,store:o});wt({el$:i},o);const s=H(()=>{const{childNodes:f}=r.value,v=n?n.hasFilteredOptions!==0:!1;return(!f||f.length===0||f.every(({visible:B})=>!B))&&!v});w(()=>e.currentNodeKey,f=>{o.value.setCurrentNodeKey(f)}),w(()=>e.defaultCheckedKeys,f=>{o.value.setDefaultCheckedKey(f)}),w(()=>e.defaultExpandedKeys,f=>{o.value.setDefaultExpandedKeys(f)}),w(()=>e.data,f=>{o.value.setData(f)},{deep:!0}),w(()=>e.checkStrictly,f=>{o.value.checkStrictly=f});const c=f=>{if(!e.filterNodeMethod)throw new Error("[Tree] filterNodeMethod is required when filter");o.value.filter(f)},y=f=>xe(e.nodeKey,f.data),g=f=>{if(!e.nodeKey)throw new Error("[Tree] nodeKey is required in getNodePath");const v=o.value.getNode(f);if(!v)return[];const B=[v.data];let X=v.parent;for(;X&&X!==r.value;)B.push(X.data),X=X.parent;return B.reverse()},C=(f,v)=>o.value.getCheckedNodes(f,v),b=f=>o.value.getCheckedKeys(f),D=()=>{const f=o.value.getCurrentNode();return f?f.data:null},S=()=>{if(!e.nodeKey)throw new Error("[Tree] nodeKey is required in getCurrentKey");const f=D();return f?f[e.nodeKey]:null},k=(f,v)=>{if(!e.nodeKey)throw new Error("[Tree] nodeKey is required in setCheckedNodes");o.value.setCheckedNodes(f,v)},K=(f,v)=>{if(!e.nodeKey)throw new Error("[Tree] nodeKey is required in setCheckedKeys");o.value.setCheckedKeys(f,v)},q=(f,v,B)=>{o.value.setChecked(f,v,B)},O=()=>o.value.getHalfCheckedNodes(),_=()=>o.value.getHalfCheckedKeys(),p=(f,v=!0)=>{if(!e.nodeKey)throw new Error("[Tree] nodeKey is required in setCurrentNode");Ce(o,t.emit,()=>{l(f),o.value.setUserCurrentNode(f,v)})},m=(f,v=!0)=>{if(!e.nodeKey)throw new Error("[Tree] nodeKey is required in setCurrentKey");Ce(o,t.emit,()=>{l(),o.value.setCurrentNodeKey(f,v)})},E=f=>o.value.getNode(f),G=f=>{o.value.remove(f)},He=(f,v)=>{o.value.append(f,v)},Ve=(f,v)=>{o.value.insertBefore(f,v)},ze=(f,v)=>{o.value.insertAfter(f,v)},Fe=(f,v,B)=>{l(v),t.emit("node-expand",f,v,B)},je=(f,v)=>{if(!e.nodeKey)throw new Error("[Tree] nodeKey is required in updateKeyChild");o.value.updateChildren(f,v)};return ne("RootTree",{ctx:t,props:e,store:o,root:r,currentNode:u,instance:Ee()}),ne(rt,void 0),{ns:a,store:o,root:r,currentNode:u,dragState:h,el$:i,dropIndicator$:N,isEmpty:s,filter:c,getNodeKey:y,getNodePath:g,getCheckedNodes:C,getCheckedKeys:b,getCurrentNode:D,getCurrentKey:S,setCheckedNodes:k,setCheckedKeys:K,setChecked:q,getHalfCheckedNodes:O,getHalfCheckedKeys:_,setCurrentNode:p,setCurrentKey:m,t:d,getNode:E,remove:G,append:He,insertBefore:Ve,insertAfter:ze,handleNodeExpand:Fe,updateKeyChildren:je}}});function Tt(e,t,d,a,n,o){const r=$("el-tree-node");return T(),W("div",{ref:"el$",class:A([e.ns.b(),e.ns.is("dragging",!!e.dragState.draggingNode),e.ns.is("drop-not-allow",!e.dragState.allowDrop),e.ns.is("drop-inner",e.dragState.dropType==="inner"),{[e.ns.m("highlight-current")]:e.highlightCurrent}]),role:"tree"},[(T(!0),W(Be,null,Le(e.root.childNodes,u=>(T(),M(r,{key:e.getNodeKey(u),node:u,props:e.props,accordion:e.accordion,"render-after-expand":e.renderAfterExpand,"show-checkbox":e.showCheckbox,"render-content":e.renderContent,onNodeExpand:e.handleNodeExpand},null,8,["node","props","accordion","render-after-expand","show-checkbox","render-content","onNodeExpand"]))),128)),e.isEmpty?(T(),W("div",{key:0,class:A(e.ns.e("empty-block"))},[be(e.$slots,"empty",{},()=>{var u;return[pe("span",{class:A(e.ns.e("empty-text"))},at((u=e.emptyText)!=null?u:e.t("el.tree.emptyText")),3)]})],2)):J("v-if",!0),ye(pe("div",{ref:"dropIndicator$",class:A(e.ns.e("drop-indicator"))},null,2),[[ge,e.dragState.showDropIndicator]])],2)}var Ot=de(St,[["render",Tt],["__file","tree.vue"]]);const ve=Ke(Ot),At=(e,{attrs:t,emit:d},{select:a,tree:n,key:o})=>{const r=j("tree-select");return w(()=>e.data,()=>{e.filterable&&V(()=>{var i,N;(N=n.value)==null||N.filter((i=a.value)==null?void 0:i.states.inputValue)})},{flush:"post"}),{...le(Me(e),Object.keys(Ne.props)),...t,"onUpdate:modelValue":i=>d(Z,i),valueKey:o,popperClass:H(()=>{const i=[r.e("popper")];return e.popperClass&&i.push(e.popperClass),i.join(" ")}),filterMethod:(i="")=>{var N;e.filterMethod?e.filterMethod(i):e.remoteMethod?e.remoteMethod(i):(N=n.value)==null||N.filter(i)}}},Bt=I({extends:Te,setup(e,t){const d=Te.setup(e,t);delete d.selectOptionClick;const a=Ee().proxy;return V(()=>{d.select.states.cachedOptions.get(a.value)||d.select.onOptionCreate(a)}),w(()=>t.attrs.visible,n=>{d.states.visible=n},{immediate:!0}),d},methods:{selectOptionClick(){this.$el.parentElement.click()}}});function me(e){return e||e===0}function we(e){return U(e)&&e.length}function R(e){return U(e)?e:me(e)?[e]:[]}function re(e,t,d,a,n){for(let o=0;o<e.length;o++){const r=e[o];if(t(r,o,e,n))return a?a(r,o,e,n):r;{const u=d(r);if(we(u)){const i=re(u,t,d,a,r);if(i)return i}}}}function ie(e,t,d,a){for(let n=0;n<e.length;n++){const o=e[n];t(o,n,e,a);const r=d(o);we(r)&&ie(r,t,d,o)}}const Lt=(e,{attrs:t,slots:d,emit:a},{select:n,tree:o,key:r})=>{w(()=>e.modelValue,()=>{e.showCheckbox&&V(()=>{const s=o.value;s&&!ht(s.getCheckedKeys(),R(e.modelValue))&&s.setCheckedKeys(R(e.modelValue))})},{immediate:!0,deep:!0});const u=H(()=>({value:r.value,label:"label",children:"children",disabled:"disabled",isLeaf:"isLeaf",...e.props})),i=(s,c)=>{var y;const g=u.value[s];return te(g)?g(c,(y=o.value)==null?void 0:y.getNode(i("value",c))):c[g]},N=R(e.modelValue).map(s=>re(e.data||[],c=>i("value",c)===s,c=>i("children",c),(c,y,g,C)=>C&&i("value",C))).filter(s=>me(s)),l=H(()=>{if(!e.renderAfterExpand&&!e.lazy)return[];const s=[];return ie(e.data.concat(e.cacheData),c=>{const y=i("value",c);s.push({value:y,currentLabel:i("label",c),isDisabled:i("disabled",c)})},c=>i("children",c)),s}),h=()=>{var s;return(s=o.value)==null?void 0:s.getCheckedKeys().filter(c=>{var y;const g=(y=o.value)==null?void 0:y.getNode(c);return!lt(g)&&it(g.childNodes)})};return{...le(Me(e),Object.keys(ve.props)),...t,nodeKey:r,expandOnClickNode:H(()=>!e.checkStrictly&&e.expandOnClickNode),defaultExpandedKeys:H(()=>e.defaultExpandedKeys?e.defaultExpandedKeys.concat(N):N),renderContent:(s,{node:c,data:y,store:g})=>s(Bt,{value:i("value",y),label:i("label",y),disabled:i("disabled",y),visible:c.visible},e.renderContent?()=>e.renderContent(s,{node:c,data:y,store:g}):d.default?()=>d.default({node:c,data:y,store:g}):void 0),filterNodeMethod:(s,c,y)=>e.filterNodeMethod?e.filterNodeMethod(s,c,y):s?new RegExp(ft(s),"i").test(i("label",c)||""):!0,onNodeClick:(s,c,y)=>{var g,C,b,D;if((g=t.onNodeClick)==null||g.call(t,s,c,y),!(e.showCheckbox&&e.checkOnClickNode)){if(!e.showCheckbox&&(e.checkStrictly||c.isLeaf)){if(!i("disabled",s)){const S=(C=n.value)==null?void 0:C.states.options.get(i("value",s));(b=n.value)==null||b.handleOptionSelect(S)}}else e.expandOnClickNode&&y.proxy.handleExpandIconClick();(D=n.value)==null||D.focus()}},onCheck:(s,c)=>{var y;if(!e.showCheckbox)return;const g=i("value",s),C={};ie([o.value.store.root],k=>C[k.key]=k,k=>k.childNodes);const b=c.checkedKeys,D=e.multiple?R(e.modelValue).filter(k=>!(k in C)&&!b.includes(k)):[],S=D.concat(b);if(e.checkStrictly)a(Z,e.multiple?S:S.includes(g)?g:void 0);else if(e.multiple){const k=h();a(Z,D.concat(k))}else{const k=re([s],O=>!we(i("children",O))&&!i("disabled",O),O=>i("children",O)),K=k?i("value",k):void 0,q=me(e.modelValue)&&!!re([s],O=>i("value",O)===e.modelValue,O=>i("children",O));a(Z,K===e.modelValue||q?void 0:K)}V(()=>{var k;const K=R(e.modelValue);o.value.setCheckedKeys(K),(k=t.onCheck)==null||k.call(t,s,{checkedKeys:o.value.getCheckedKeys(),checkedNodes:o.value.getCheckedNodes(),halfCheckedKeys:o.value.getHalfCheckedKeys(),halfCheckedNodes:o.value.getHalfCheckedNodes()})}),(y=n.value)==null||y.focus()},onNodeExpand:(s,c,y)=>{var g;(g=t.onNodeExpand)==null||g.call(t,s,c,y),V(()=>{if(!e.checkStrictly&&e.lazy&&e.multiple&&c.checked){const C={},b=o.value.getCheckedKeys();ie([o.value.store.root],k=>C[k.key]=k,k=>k.childNodes);const D=R(e.modelValue).filter(k=>!(k in C)&&!b.includes(k)),S=h();a(Z,D.concat(S))}})},cacheOptions:l}};var Mt=I({props:{data:{type:Array,default:()=>[]}},setup(e){const t=F(Ie);return w(()=>e.data,()=>{var d;e.data.forEach(n=>{t.states.cachedOptions.has(n.value)||t.states.cachedOptions.set(n.value,n)});const a=((d=t.selectRef)==null?void 0:d.querySelectorAll("input"))||[];ct&&!Array.from(a).includes(document.activeElement)&&t.setSelected()},{flush:"post",immediate:!0}),()=>{}}});const It=I({name:"ElTreeSelect",inheritAttrs:!1,props:{...Ne.props,...ve.props,cacheData:{type:Array,default:()=>[]}},setup(e,t){const{slots:d,expose:a}=t,n=x(),o=x(),r=H(()=>e.nodeKey||e.valueKey||"value"),u=At(e,t,{select:n,tree:o,key:r}),{cacheOptions:i,...N}=Lt(e,t,{select:n,tree:o,key:r}),l=se({});return a(l),De(()=>{Object.assign(l,{...le(o.value,["filter","updateKeyChildren","getCheckedNodes","setCheckedNodes","getCheckedKeys","setCheckedKeys","setChecked","getHalfCheckedNodes","getHalfCheckedKeys","getCurrentKey","getCurrentNode","setCurrentKey","setCurrentNode","getNode","remove","append","insertBefore","insertAfter"]),...le(n.value,["focus","blur","selectedLabel"])})}),()=>ee(Ne,se({...u,ref:h=>n.value=h}),{...d,default:()=>[ee(Mt,{data:i.value}),ee(ve,se({...N,ref:h=>o.value=h}))]})}});var Pt=de(It,[["__file","tree-select.vue"]]);const $t=Ke(Pt),jt={__name:"SelectProductCategory",props:{modelValue:{type:[String,Number],default:null}},emits:["update:modelValue"],setup(e,{emit:t}){const d=t,a=e,n={children:"descendants",label:"name",disabled:"disabled"},o=x([]),r=x(a.modelValue),u=x(!1);w(()=>a.modelValue,l=>{r.value=l});const i=async()=>{try{u.value=!0;const l=await ut.get("/product/category/data");l.status===200&&(o.value=l.data),u.value=!1}catch{}};De(()=>{i()});const N=l=>{console.log(l),r.value=l,d("update:modelValue",l)};return(l,h)=>{const s=$t;return T(),M(s,{"node-key":"id",class:"w-full",modelValue:r.value,"onUpdate:modelValue":h[0]||(h[0]=c=>r.value=c),filterable:"",clearable:"",remote:"",data:o.value,"render-after-expand":!1,onChange:N,props:n,loading:u.value},null,8,["modelValue","data","loading"])}}};export{jt as _};
