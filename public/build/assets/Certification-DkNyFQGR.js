import{g as d,t as s,i as le,a as ne,o as se,w as o,d as m,b as e,j as c,f as u,u as r,I as $,E as re,e as w,n as me,p as ie,q as ce,l as D}from"./app-BGxfkQyo.js";import{_ as ue,a as de,b as pe,E as b}from"./lodash-B8vTn4c7.js";import{u as _e,E as fe,a as ge,S as ve,b as be}from"./SkeletonTable-D3dCL_hH.js";import{_ as he}from"./ImageUpload-BKts1VHv.js";import{u as we}from"./baseComposable-D_W31vg_.js";import{E as ye,a as Ee}from"./index-D86IKBYl.js";import{E as $e}from"./index-BJIagJY3.js";import{E as Ce}from"./index-D_ov1zZm.js";import{E as Ve,a as ke}from"./index-CyV8PQJT.js";import{E as Se}from"./index-CyDS6CXJ.js";import{E as xe}from"./index-DY15ID-N.js";import{E as Be,a as De}from"./index-CvhItr7_.js";import{E as Te}from"./index-DDRuwiU-.js";import"./scroll-B9W2qgUL.js";import"./index-CYh1QxFF.js";import"./validator-DuQ1bq1g.js";import"./index-BPi1rbym.js";import"./position-BiuuCdhY.js";import"./directive-Chdceyer.js";const Ie={class:"content"},qe={class:"content-header"},Fe={class:"mt-auto mb-0"},Ue={class:"text-lg font-semibold"},je={class:"mt-auto mb-0"},Me={class:"flex justify-between items-center p-4"},Ne={class:"flex items-center gap-2"},Pe={class:"flex justify-between items-center p-4"},Re={class:"flex items-center gap-2"},Le={class:"flex items-center gap-2"},ze={class:"text-end"},ua={__name:"Certification",setup(Ke){const{objectToFormData:q}=we(),p=d({page:1,limit:25,search:""}),F=d([]),U=async({queryKey:a})=>{const[n,i]=a;return(await D.get("/certification/data",{params:i})).data},{data:_,isLoading:C,isError:Oe,error:Qe,refetch:g}=_e({queryKey:["fetchData",p.value],queryFn:U,keepPreviousData:!0}),j=ue.debounce(()=>{p.value.page=1,g()},1e3),M=a=>{F.value=a},N=()=>{g()},P=a=>{p.value.page=a,g()},R=(a,n)=>{var i="";if(a)for(let f=0;f<=a;f++)i+="â€”";return i+" "+n},V=d(null),v=d(!1),k=d(""),t=d({id:null,name:null,date_exp:null,image:null}),L=d({name:[{required:!0,message:s("validation.required",{attribute:s("common.name")}),trigger:"blur"}]}),S=d(!1),z=()=>{k.value=`${s("common.create")} ${s("base.certification")}`,v.value=!0,t.value.id=null,t.value.name=null,t.value.date_exp=null,t.value.image=null},K=(a,n="id")=>{k.value=`${s("common.edit")} ${s("base.certification")}`,v.value=!0,t.value.id=a.id,t.value.name=a.name,t.value.date_exp=a.date_exp,t.value.image=a.image!="/images/placeholder/product.png"?a.image:null},T=()=>{v.value=!1,t.value.id=null,t.value.name=null,t.value.date_exp=null,t.value.image=null},O=async()=>{V.value&&V.value.validate(async a=>{if(a){const n=Te.service({customClass:"rounded-md",target:document.querySelector("#modalForm")});try{S.value=!0;const i=t.value.id?`/certification/${t.value.id}/update`:"/certification/store",f="post",h=q(t.value);await D({method:f,url:i,data:h,headers:{"Content-Type":"multipart/form-data"}}),S.value=!1,v.value=!1,g(),T(),b({message:s("message.success_save"),type:"success"})}catch(i){console.log(i),S.value=!1,b({message:s("message.error_server"),type:"error"})}n.close()}else b({message:s("message.error_input"),type:"error"})})},Q=a=>{be.confirm(s("message.delete_confirm"),s("message.delete_confirm_title"),{confirmButtonText:s("common.ok"),cancelButtonText:s("common.cancel"),type:"warning"}).then(()=>{D.delete(`/product/certification/${a}/delete`).then(()=>{g(),b({type:"success",message:s("message.delete_success")})}).catch(n=>{b({type:"error",message:s("message.delete_cancel")})})}).catch(()=>{b({type:"info",message:s("message.delete_cancel")})})};return(a,n)=>{const i=Ee,f=ye,h=pe,A=de,x=Ce,y=re,E=ke,G=Se,I=ce,H=ie,J=me,W=Ve,X=ge,Y=fe,Z=$e,B=De,ee=Be,ae=xe,oe=le("base-layout");return se(),ne(oe,null,{default:o(()=>[m("div",Ie,[m("div",qe,[m("div",Fe,[m("div",Ue,c(a.$t("base.certification")),1)]),m("div",je,[e(f,{separator:"/"},{default:o(()=>[e(i,{to:{path:"/dashboard"}},{default:o(()=>[u(c(a.$t("base.dashboard")),1)]),_:1}),e(i,null,{default:o(()=>[u(c(a.$t("base.certification")),1)]),_:1})]),_:1})])]),e(Z,{"body-class":"!p-0",class:"!rounded-lg !shadow-md !mb-10"},{default:o(()=>[m("div",Me,[e(A,{modelValue:p.value.limit,"onUpdate:modelValue":n[0]||(n[0]=l=>p.value.limit=l),placeholder:a.$t("common.select"),class:"w-24",onChange:r(g),disable:r(C)},{default:o(()=>[e(h,{label:"25",value:"25"}),e(h,{label:"50",value:"50"}),e(h,{label:"100",value:"100"})]),_:1},8,["modelValue","placeholder","onChange","disable"]),m("div",Ne,[e(x,{modelValue:p.value.search,"onUpdate:modelValue":n[1]||(n[1]=l=>p.value.search=l),clearable:"",onInput:r(j),disable:r(C)},{prefix:o(()=>[e(r($),{icon:"mingcute:search-line"})]),_:1},8,["modelValue","onInput","disable"]),e(y,{type:"primary",onClick:w(z,["prevent"])},{default:o(()=>[e(r($),{icon:"mingcute:add-line",class:"me-2"}),u(" "+c(a.$t("common.create")),1)]),_:1})])]),e(Y,{loading:r(C),animated:""},{template:o(()=>[e(ve)]),default:o(()=>[e(W,{class:"min-w-full",data:r(_).data,onSortChange:N,onSelectionChange:M},{default:o(()=>[e(E,{type:"selection",width:"55"}),e(E,{label:a.$t("common.image"),width:"90"},{default:o(l=>[e(G,{class:"!w-14 !h-14 rounded-md me-2",src:l.row.image,"preview-src-list":[l.row.image],"initial-index":0,"preview-teleported":""},null,8,["src","preview-src-list"])]),_:1},8,["label"]),e(E,{label:a.$t("common.name"),sortable:""},{default:o(l=>[u(c(R(l.row.depth,l.row.name)),1)]),_:1},8,["label"]),e(E,{label:a.$t("common.action"),align:"center",width:"150"},{default:o(l=>[e(J,{"popper-class":"dropdown-action",trigger:"click"},{dropdown:o(()=>[e(H,null,{default:o(()=>[e(I,{class:"flex justify-between",onClick:w(te=>K(l.row),["prevent"])},{default:o(()=>[e(r($),{icon:"mingcute:edit-line",class:"me-2"}),u(" "+c(a.$t("common.edit")),1)]),_:2},1032,["onClick"]),e(I,{class:"flex justify-between",onClick:w(te=>Q(l.row.id),["prevent"])},{default:o(()=>[e(r($),{icon:"mingcute:delete-2-line",class:"me-2"}),u(" "+c(a.$t("common.delete")),1)]),_:2},1032,["onClick"])]),_:2},1024)]),default:o(()=>[e(y,{type:"primary"},{default:o(()=>[u(c(a.$t("common.action")),1)]),_:1})]),_:2},1024)]),_:1},8,["label"])]),_:1},8,["data"]),m("div",Pe,[m("div",Re,[m("span",null,c(a.$t("common.table_paginate",{from:r(_).from,to:r(_).to,total:r(_).total})),1)]),m("div",Le,[e(X,{class:"float-end",background:"",layout:"prev, pager, next","page-size":r(_).per_page,total:r(_).total,"current-page":r(_).current_page,onCurrentChange:P},null,8,["page-size","total","current-page"])])])]),_:1},8,["loading"])]),_:1}),e(ae,{id:"modalForm",modelValue:v.value,"onUpdate:modelValue":n[5]||(n[5]=l=>v.value=l),title:k.value,class:"!sm:w-full !w-1/3 rounded-lg","close-on-click-modal":!1,"close-on-press-escape":!1},{default:o(()=>[e(ee,{"label-position":"top",ref_key:"formRef",ref:V,model:t.value,rules:L.value,onSubmit:w(O,["prevent"])},{default:o(()=>[e(B,{label:a.$t("common.name"),prop:"name"},{default:o(()=>[e(x,{modelValue:t.value.name,"onUpdate:modelValue":n[2]||(n[2]=l=>t.value.name=l)},null,8,["modelValue"])]),_:1},8,["label"]),e(B,{label:"Tanggal Berlaku",prop:"date_exp"},{default:o(()=>[e(x,{modelValue:t.value.date_exp,"onUpdate:modelValue":n[3]||(n[3]=l=>t.value.date_exp=l)},null,8,["modelValue"])]),_:1}),e(B,{label:a.$t("common.image"),prop:"image"},{default:o(()=>[e(he,{modelValue:t.value.image,"onUpdate:modelValue":n[4]||(n[4]=l=>t.value.image=l),class:"w-28 h-28"},null,8,["modelValue"])]),_:1},8,["label"]),m("div",ze,[e(y,{onClick:w(T,["prevent"])},{default:o(()=>[u(c(a.$t("common.cancel")),1)]),_:1}),e(y,{type:"primary","native-type":"submit"},{default:o(()=>[u(c(a.$t("common.save")),1)]),_:1})])]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])])]),_:1})}}};export{ua as default};
