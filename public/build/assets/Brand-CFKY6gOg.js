import{g as d,t,i as oe,a as te,o as le,w as o,d as m,b as e,j as c,f as i,u as l,I as E,E as ne,e as h,n as se,p as re,q as me,l as B}from"./app-BGxfkQyo.js";import{_ as ce,a as de,b as ie,E as v}from"./lodash-B8vTn4c7.js";import{u as ue,E as pe,a as _e,S as fe,b as ge}from"./SkeletonTable-D3dCL_hH.js";import{E as ve,a as be}from"./index-D86IKBYl.js";import{E as he}from"./index-BJIagJY3.js";import{E as ye}from"./index-D_ov1zZm.js";import{E as we,a as Ee}from"./index-CyV8PQJT.js";import{E as $e}from"./index-CyDS6CXJ.js";import{E as ke}from"./index-DY15ID-N.js";import{E as Ce,a as Ve}from"./index-CvhItr7_.js";import{E as Se}from"./index-DDRuwiU-.js";import"./scroll-B9W2qgUL.js";import"./index-CYh1QxFF.js";import"./validator-DuQ1bq1g.js";import"./index-BPi1rbym.js";import"./position-BiuuCdhY.js";import"./directive-Chdceyer.js";const Be={class:"content"},De={class:"content-header"},Ie={class:"mt-auto mb-0"},qe={class:"text-lg font-semibold"},Te={class:"mt-auto mb-0"},Fe={class:"flex justify-between items-center p-4"},je={class:"flex items-center gap-2"},Me={class:"flex justify-between items-center p-4"},Pe={class:"flex items-center gap-2"},Re={class:"flex items-center gap-2"},Ue={class:"text-end"},na={__name:"Brand",setup(xe){const u=d({page:1,limit:25,search:""}),T=d([]),F=async({queryKey:a})=>{const[r,_]=a;return(await B.get("/product/brand/data",{params:_})).data},{data:p,isLoading:$,isError:Le,error:Ne,refetch:f}=ue({queryKey:["fetchData",u.value],queryFn:F,keepPreviousData:!0}),j=ce.debounce(()=>{u.value.page=1,f()},1e3),M=a=>{T.value=a},P=()=>{f()},R=a=>{u.value.page=a,f()},k=d(null),g=d(!1),C=d(""),n=d({id:null,name:null}),U=d({name:[{required:!0,message:t("validation.required",{attribute:t("common.name")}),trigger:"blur"}]}),V=d(!1),x=()=>{C.value=`${t("common.create")} ${t("base.packaging")}`,g.value=!0,n.value.id=null,n.value.name=null},L=a=>{C.value=`${t("common.edit")} ${t("base.packaging")}`,g.value=!0,n.value.id=a.id,n.value.name=a.name},D=()=>{g.value=!1,n.value.id=null,n.value.name=null},N=async()=>{k.value&&k.value.validate(async a=>{if(a){const r=Se.service({customClass:"rounded-md",target:document.querySelector("#modalForm")});try{V.value=!0;const _=n.value.id?`/product/brand/${n.value.id}/update`:"/product/brand/store",y=n.value.id?"put":"post";await B({method:y,url:_,data:n.value}),V.value=!1,g.value=!1,f(),D(),v({message:t("message.success_save"),type:"success"})}catch{V.value=!1,v({message:t("message.error_server"),type:"error"})}r.close()}else v({message:t("message.error_input"),type:"error"})})},z=a=>{ge.confirm(t("message.delete_confirm"),t("message.delete_confirm_title"),{confirmButtonText:t("common.ok"),cancelButtonText:t("common.cancel"),type:"warning"}).then(()=>{B.delete(`/product/brand/${a}/delete`).then(()=>{f(),v({type:"success",message:t("message.delete_success")})}).catch(r=>{v({type:"error",message:t("message.delete_cancel")})})}).catch(()=>{v({type:"info",message:t("message.delete_cancel")})})};return(a,r)=>{const _=be,y=ve,S=ie,K=de,I=ye,w=ne,b=Ee,O=$e,q=me,Q=re,A=se,G=we,H=_e,J=pe,W=he,X=Ve,Y=Ce,Z=ke,ee=oe("base-layout");return le(),te(ee,null,{default:o(()=>[m("div",Be,[m("div",De,[m("div",Ie,[m("div",qe,c(a.$t("base.brand")),1)]),m("div",Te,[e(y,{separator:"/"},{default:o(()=>[e(_,{to:{path:"/dashboard"}},{default:o(()=>[i(c(a.$t("base.dashboard")),1)]),_:1}),e(_,null,{default:o(()=>[i(c(a.$t("base.product")),1)]),_:1})]),_:1})])]),e(W,{"body-class":"!p-0",class:"!rounded-lg !shadow-md !mb-10"},{default:o(()=>[m("div",Fe,[e(K,{modelValue:u.value.limit,"onUpdate:modelValue":r[0]||(r[0]=s=>u.value.limit=s),placeholder:a.$t("common.select"),class:"w-24",onChange:l(f),disable:l($)},{default:o(()=>[e(S,{label:"25",value:"25"}),e(S,{label:"50",value:"50"}),e(S,{label:"100",value:"100"})]),_:1},8,["modelValue","placeholder","onChange","disable"]),m("div",je,[e(I,{modelValue:u.value.search,"onUpdate:modelValue":r[1]||(r[1]=s=>u.value.search=s),clearable:"",onInput:l(j),disable:l($)},{prefix:o(()=>[e(l(E),{icon:"mingcute:search-line"})]),_:1},8,["modelValue","onInput","disable"]),e(w,{type:"primary",onClick:h(x,["prevent"])},{default:o(()=>[e(l(E),{icon:"mingcute:add-line",class:"me-2"}),i(" "+c(a.$t("common.create")),1)]),_:1})])]),e(J,{loading:l($),animated:""},{template:o(()=>[e(fe)]),default:o(()=>[e(G,{class:"min-w-full",data:l(p).data,onSortChange:P,onSelectionChange:M},{default:o(()=>[e(b,{type:"selection",width:"55"}),e(b,{label:a.$t("common.image")},{default:o(s=>[e(O,{class:"!w-24 !h-14 rounded-md me-2",src:s.row.image,"preview-src-list":[s.row.image],"initial-index":0,"preview-teleported":""},null,8,["src","preview-src-list"])]),_:1},8,["label"]),e(b,{prop:"name",label:a.$t("common.name"),sortable:""},null,8,["label"]),e(b,{prop:"product_count",label:a.$t("common.total_data",{data:a.$t("base.product")}),sortable:""},null,8,["label"]),e(b,{label:a.$t("common.action"),align:"center",width:"150"},{default:o(s=>[e(A,{"popper-class":"dropdown-action",trigger:"click"},{dropdown:o(()=>[e(Q,null,{default:o(()=>[e(q,{class:"flex justify-between",onClick:h(ae=>L(s.row),["prevent"])},{default:o(()=>[e(l(E),{icon:"mingcute:edit-line",class:"me-2"}),i(" "+c(a.$t("common.edit")),1)]),_:2},1032,["onClick"]),e(q,{class:"flex justify-between",onClick:h(ae=>z(s.row.id),["prevent"])},{default:o(()=>[e(l(E),{icon:"mingcute:delete-2-line",class:"me-2"}),i(" "+c(a.$t("common.delete")),1)]),_:2},1032,["onClick"])]),_:2},1024)]),default:o(()=>[e(w,{type:"primary"},{default:o(()=>[i(c(a.$t("common.action")),1)]),_:1})]),_:2},1024)]),_:1},8,["label"])]),_:1},8,["data"]),m("div",Me,[m("div",Pe,[m("span",null,c(a.$t("common.table_paginate",{from:l(p).from,to:l(p).to,total:l(p).total})),1)]),m("div",Re,[e(H,{class:"float-end",background:"",layout:"prev, pager, next","page-size":l(p).per_page,total:l(p).total,"current-page":l(p).current_page,onCurrentChange:R},null,8,["page-size","total","current-page"])])])]),_:1},8,["loading"])]),_:1}),e(Z,{id:"modalForm",modelValue:g.value,"onUpdate:modelValue":r[3]||(r[3]=s=>g.value=s),title:C.value,class:"!sm:w-full !w-1/3 rounded-lg","close-on-click-modal":!1,"close-on-press-escape":!1},{default:o(()=>[e(Y,{"label-position":"top",ref_key:"formRef",ref:k,model:n.value,rules:U.value,onSubmit:h(N,["prevent"])},{default:o(()=>[e(X,{label:a.$t("common.name"),prop:"name"},{default:o(()=>[e(I,{modelValue:n.value.name,"onUpdate:modelValue":r[2]||(r[2]=s=>n.value.name=s)},null,8,["modelValue"])]),_:1},8,["label"]),m("div",Ue,[e(w,{onClick:h(D,["prevent"])},{default:o(()=>[i(c(a.$t("common.cancel")),1)]),_:1}),e(w,{type:"primary","native-type":"submit"},{default:o(()=>[i(c(a.$t("common.save")),1)]),_:1})])]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])])]),_:1})}}};export{na as default};
